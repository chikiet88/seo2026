<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chi Ti·∫øt C√¥ng Vi·ªác Tu·∫ßn/Ng√†y - KPI SEO 2026</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="gantt-tasks-vi.js"></script>
  <style>
    .tab-active { border-bottom: 3px solid #3b82f6; color: #3b82f6; font-weight: 600; }
    .view-active { background: #3b82f6; color: white; }
    .task-card { transition: all 0.2s; }
    .task-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <div class="max-w-7xl mx-auto p-4">
    <!-- Ti√™u ƒë·ªÅ -->
    <div class="bg-gradient-to-r from-orange-500 to-red-600 text-white p-6 rounded-lg mb-6 shadow-lg">
      <div class="flex justify-between items-center">
        <div>
          <h1 class="text-3xl font-bold">üóìÔ∏è Chi Ti·∫øt C√¥ng Vi·ªác Theo Tu·∫ßn/Ng√†y</h1>
          <p class="mt-2 opacity-90">KPI SEO 2026 TazaGroup ‚Ä¢ 52 tu·∫ßn c√¥ng vi·ªác chi ti·∫øt</p>
        </div>
        <a href="kpi-full-vi.html" class="bg-white text-orange-600 px-4 py-2 rounded-lg font-semibold hover:bg-orange-100">
          ‚Üê Quay v·ªÅ T·ªïng Quan
        </a>
      </div>
    </div>

    <!-- ƒêi·ªÅu khi·ªÉn -->
    <div class="bg-white rounded-lg shadow mb-6 p-4">
      <div class="flex flex-wrap gap-4 items-center justify-between">
        <!-- Ch·∫ø ƒë·ªô xem -->
        <div class="flex gap-2">
          <button onclick="setView('week')" id="view-week" class="px-4 py-2 rounded-lg border view-active">üìÖ Xem Tu·∫ßn</button>
          <button onclick="setView('day')" id="view-day" class="px-4 py-2 rounded-lg border hover:bg-gray-100">üìÜ Xem Ng√†y</button>
          <button onclick="setView('list')" id="view-list" class="px-4 py-2 rounded-lg border hover:bg-gray-100">üìã Danh S√°ch</button>
        </div>
        
        <!-- B·ªô l·ªçc -->
        <div class="flex gap-2 flex-wrap">
          <select id="filterSite" onchange="applyFilters()" class="px-4 py-2 rounded-lg border">
            <option value="all">T·∫•t c·∫£ Website</option>
            <option value="clinic">TazaSkinClinic</option>
            <option value="timona">Timona</option>
            <option value="hderma">Hderma</option>
            <option value="elasome">Elasome</option>
            <option value="group">TazaGroup</option>
          </select>
          <select id="filterType" onchange="applyFilters()" class="px-4 py-2 rounded-lg border">
            <option value="all">T·∫•t c·∫£ Lo·∫°i</option>
            <option value="noiDung">üìù N·ªôi dung</option>
            <option value="kyThuat">‚öôÔ∏è K·ªπ thu·∫≠t</option>
            <option value="chienDich">üéØ Chi·∫øn d·ªãch</option>
            <option value="ai">ü§ñ AI/AIO</option>
            <option value="entity">üè¢ Entity</option>
            <option value="baoCao">üìä B√°o c√°o</option>
          </select>
          <button onclick="exportDetailToExcel()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg">
            üì• Xu·∫•t Excel
          </button>
        </div>
      </div>
    </div>

    <!-- Tab Qu√Ω -->
    <div class="bg-white rounded-lg shadow mb-6">
      <div class="flex overflow-x-auto border-b">
        <button onclick="showQuarter('q1')" id="btn-q1" class="px-6 py-4 whitespace-nowrap hover:bg-gray-100 tab-active">üå± Qu√Ω 1 (T1-T3)</button>
        <button onclick="showQuarter('q2')" id="btn-q2" class="px-6 py-4 whitespace-nowrap hover:bg-gray-100">‚òÄÔ∏è Qu√Ω 2 (T4-T6)</button>
        <button onclick="showQuarter('q3')" id="btn-q3" class="px-6 py-4 whitespace-nowrap hover:bg-gray-100">üçÇ Qu√Ω 3 (T7-T9)</button>
        <button onclick="showQuarter('q4')" id="btn-q4" class="px-6 py-4 whitespace-nowrap hover:bg-gray-100">‚ùÑÔ∏è Qu√Ω 4 (T10-T12)</button>
      </div>
      
      <!-- N·ªôi dung -->
      <div id="content" class="p-6">
        <!-- Render b·ªüi JavaScript -->
      </div>
    </div>

    <!-- Ch√∫ gi·∫£i -->
    <div class="bg-white rounded-lg shadow p-4 mb-6">
      <h3 class="font-bold mb-3">üìå Ch√∫ Gi·∫£i Lo·∫°i C√¥ng Vi·ªác</h3>
      <div id="legend" class="flex flex-wrap gap-2">
        <!-- Render b·ªüi JavaScript -->
      </div>
    </div>

    <!-- Footer -->
    <div class="text-center text-gray-500 py-4">
      <p>¬© 2026 TazaGroup - Chi Ti·∫øt C√¥ng Vi·ªác SEO</p>
    </div>
  </div>

  <script>
    let currentQuarter = 'q1';
    let currentView = 'week';
    let filterSite = 'all';
    let filterType = 'all';

    const SITE_COLORS = {
      all: '#374151',
      clinic: '#dc2626',
      timona: '#1e40af',
      hderma: '#059669',
      elasome: '#7c3aed',
      group: '#64748b'
    };

    const SITE_NAMES = {
      all: 'T·∫•t c·∫£',
      clinic: 'TazaSkinClinic',
      timona: 'Timona',
      hderma: 'Hderma',
      elasome: 'Elasome',
      group: 'TazaGroup'
    };

    function setView(view) {
      currentView = view;
      document.querySelectorAll('[id^="view-"]').forEach(btn => {
        btn.classList.remove('view-active');
        btn.classList.add('hover:bg-gray-100');
      });
      document.getElementById(`view-${view}`).classList.add('view-active');
      document.getElementById(`view-${view}`).classList.remove('hover:bg-gray-100');
      render();
    }

    function showQuarter(q) {
      currentQuarter = q;
      document.querySelectorAll('[id^="btn-q"]').forEach(btn => btn.classList.remove('tab-active'));
      document.getElementById(`btn-${q}`).classList.add('tab-active');
      render();
    }

    function applyFilters() {
      filterSite = document.getElementById('filterSite').value;
      filterType = document.getElementById('filterType').value;
      render();
    }

    function getFilteredTasks(weeks) {
      return weeks.map(week => ({
        ...week,
        tasks: week.tasks.filter(task => {
          const siteMatch = filterSite === 'all' || task.site === filterSite || task.site === 'all';
          const typeMatch = filterType === 'all' || task.type === filterType;
          return siteMatch && typeMatch;
        })
      })).filter(week => week.tasks.length > 0);
    }

    function render() {
      const data = GANTT_TASKS[currentQuarter];
      const filteredWeeks = getFilteredTasks(data.weeks);
      const content = document.getElementById('content');

      if (currentView === 'week') {
        content.innerHTML = renderWeekView(filteredWeeks, data.name);
      } else if (currentView === 'day') {
        content.innerHTML = renderDayView(filteredWeeks, data.name);
      } else {
        content.innerHTML = renderListView(filteredWeeks, data.name);
      }
    }

    function renderWeekView(weeks, quarterName) {
      if (weeks.length === 0) {
        return '<p class="text-gray-500 text-center py-8">Kh√¥ng c√≥ c√¥ng vi·ªác ph√π h·ª£p v·ªõi b·ªô l·ªçc</p>';
      }
      
      return `
        <h2 class="text-2xl font-bold mb-6">${quarterName}</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          ${weeks.map(week => `
            <div class="border rounded-lg overflow-hidden task-card">
              <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-3">
                <div class="font-bold">üìÖ Tu·∫ßn ${week.week}</div>
                <div class="text-sm opacity-90">${week.start} - ${week.end}/2026</div>
              </div>
              <div class="p-3 space-y-2">
                ${week.tasks.map(task => `
                  <div class="flex items-start gap-2 p-2 rounded-lg bg-gray-50 hover:bg-gray-100">
                    <span class="text-lg">${TASK_TYPES[task.type]?.icon || 'üìå'}</span>
                    <div class="flex-1">
                      <div class="text-sm font-medium">${task.task}</div>
                      <div class="flex gap-2 mt-1">
                        <span class="text-xs px-2 py-0.5 rounded" style="background:${SITE_COLORS[task.site]}20; color:${SITE_COLORS[task.site]}">${SITE_NAMES[task.site]}</span>
                        <span class="text-xs">${PRIORITIES[task.priority]?.icon || 'üü°'}</span>
                      </div>
                    </div>
                  </div>
                `).join('')}
              </div>
            </div>
          `).join('')}
        </div>
      `;
    }

    function renderDayView(weeks, quarterName) {
      if (weeks.length === 0) {
        return '<p class="text-gray-500 text-center py-8">Kh√¥ng c√≥ c√¥ng vi·ªác ph√π h·ª£p v·ªõi b·ªô l·ªçc</p>';
      }
      
      // Ph√¢n b·ªï c√¥ng vi·ªác theo ng√†y trong tu·∫ßn (bao g·ªìm Th·ª© 7)
      const daysOfWeek = ['Th·ª© 2', 'Th·ª© 3', 'Th·ª© 4', 'Th·ª© 5', 'Th·ª© 6', 'Th·ª© 7'];
      
      // H√†m ph√¢n b·ªï ƒë·ªÅu c√¥ng vi·ªác v√†o c√°c ng√†y
      function distributeTasks(tasks, numDays) {
        const distribution = Array.from({ length: numDays }, () => []);
        tasks.forEach((task, i) => {
          distribution[i % numDays].push(task);
        });
        return distribution;
      }
      
      return `
        <h2 class="text-2xl font-bold mb-6">${quarterName} - Ph√¢n B·ªï Theo Ng√†y</h2>
        ${weeks.map(week => {
          const tasksByDay = distributeTasks(week.tasks, daysOfWeek.length);
          return `
          <div class="mb-6 border rounded-lg overflow-hidden">
            <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-3">
              <div class="font-bold">üìÖ Tu·∫ßn ${week.week}: ${week.start} - ${week.end}/2026</div>
              <div class="text-sm opacity-80">${week.tasks.length} c√¥ng vi·ªác</div>
            </div>
            <div class="grid grid-cols-6 divide-x">
              ${daysOfWeek.map((day, idx) => {
                const dayTasks = tasksByDay[idx];
                return `
                  <div class="p-2">
                    <div class="text-center font-semibold text-sm text-gray-600 mb-2 pb-2 border-b">${day}</div>
                    <div class="space-y-1">
                      ${dayTasks.length > 0 ? dayTasks.map(task => `
                        <div class="text-xs p-2 rounded" style="background:${TASK_TYPES[task.type]?.color}20">
                          <div class="font-medium">${task.task}</div>
                          <div class="text-gray-500 mt-1">${SITE_NAMES[task.site]}</div>
                        </div>
                      `).join('') : '<div class="text-xs text-gray-400 text-center">-</div>'}
                    </div>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
        `}).join('')}
      `;
    }

    function renderListView(weeks, quarterName) {
      if (weeks.length === 0) {
        return '<p class="text-gray-500 text-center py-8">Kh√¥ng c√≥ c√¥ng vi·ªác ph√π h·ª£p v·ªõi b·ªô l·ªçc</p>';
      }
      
      const allTasks = weeks.flatMap(week => 
        week.tasks.map(task => ({ ...task, week: week.week, start: week.start, end: week.end }))
      );
      
      return `
        <h2 class="text-2xl font-bold mb-6">${quarterName} - Danh S√°ch (${allTasks.length} c√¥ng vi·ªác)</h2>
        <div class="overflow-x-auto">
          <table class="w-full border-collapse text-sm">
            <thead>
              <tr class="bg-gray-100">
                <th class="border p-2 text-left">Tu·∫ßn</th>
                <th class="border p-2 text-left">Th·ªùi gian</th>
                <th class="border p-2 text-left">Website</th>
                <th class="border p-2 text-left">C√¥ng vi·ªác</th>
                <th class="border p-2 text-left">Lo·∫°i</th>
                <th class="border p-2 text-center">∆Øu ti√™n</th>
              </tr>
            </thead>
            <tbody>
              ${allTasks.map((task, i) => `
                <tr class="${i % 2 === 0 ? 'bg-white' : 'bg-gray-50'} hover:bg-blue-50">
                  <td class="border p-2 font-semibold">${task.week}</td>
                  <td class="border p-2 text-gray-600">${task.start} - ${task.end}</td>
                  <td class="border p-2">
                    <span class="px-2 py-1 rounded text-xs text-white" style="background:${SITE_COLORS[task.site]}">${SITE_NAMES[task.site]}</span>
                  </td>
                  <td class="border p-2">${task.task}</td>
                  <td class="border p-2">
                    <span class="px-2 py-1 rounded text-xs text-white" style="background:${TASK_TYPES[task.type]?.color || '#888'}">${TASK_TYPES[task.type]?.icon || ''} ${TASK_TYPES[task.type]?.name || task.type}</span>
                  </td>
                  <td class="border p-2 text-center">${PRIORITIES[task.priority]?.icon || 'üü°'}</td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      `;
    }

    function exportDetailToExcel() {
      const wb = XLSX.utils.book_new();
      
      // Xu·∫•t t·ª´ng qu√Ω
      Object.entries(GANTT_TASKS).forEach(([qKey, qData]) => {
        const rows = [['Tu·∫ßn', 'B·∫Øt ƒë·∫ßu', 'K·∫øt th√∫c', 'Website', 'C√¥ng vi·ªác', 'Lo·∫°i', '∆Øu ti√™n']];
        qData.weeks.forEach(week => {
          week.tasks.forEach(task => {
            rows.push([
              week.week,
              week.start,
              week.end,
              SITE_NAMES[task.site],
              task.task,
              TASK_TYPES[task.type]?.name || task.type,
              PRIORITIES[task.priority]?.name || task.priority
            ]);
          });
        });
        XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(rows), qData.name.substring(0, 31));
      });
      
      // Sheet t·ªïng h·ª£p
      const allRows = [['Qu√Ω', 'Tu·∫ßn', 'B·∫Øt ƒë·∫ßu', 'K·∫øt th√∫c', 'Website', 'C√¥ng vi·ªác', 'Lo·∫°i', '∆Øu ti√™n']];
      Object.entries(GANTT_TASKS).forEach(([qKey, qData]) => {
        qData.weeks.forEach(week => {
          week.tasks.forEach(task => {
            allRows.push([
              qData.name,
              week.week,
              week.start,
              week.end,
              SITE_NAMES[task.site],
              task.task,
              TASK_TYPES[task.type]?.name || task.type,
              PRIORITIES[task.priority]?.name || task.priority
            ]);
          });
        });
      });
      XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(allRows), 'T·ªïng H·ª£p');
      
      XLSX.writeFile(wb, 'Chi_Tiet_Cong_Viec_SEO_2026.xlsx');
    }

    // Render ch√∫ gi·∫£i
    function renderLegend() {
      const legend = document.getElementById('legend');
      legend.innerHTML = Object.entries(TASK_TYPES).map(([key, val]) => `
        <span class="px-3 py-1 rounded-full text-sm text-white" style="background:${val.color}">
          ${val.icon} ${val.name}
        </span>
      `).join('');
    }

    // Kh·ªüi t·∫°o
    document.addEventListener('DOMContentLoaded', () => {
      renderLegend();
      render();
    });
  </script>
</body>
</html>
